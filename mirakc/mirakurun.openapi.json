{"swagger":"2.0","info":{"title":"Mirakurun","version":"2.14.0","description":"DVR Tuner Server Service for Chinachu Air.","contact":{"name":"Yuki KAN","url":"https://github.com/kanreisa"}},"basePath":"/api","consumes":["application/json"],"produces":["application/json"],"paths":{"/version/update":{"parameters":[],"put":{"tags":["version"],"operationId":"updateVersion","produces":["text/plain","application/json"],"parameters":[{"in":"query","name":"force","type":"boolean","required":false}],"responses":{"202":{"description":"Accepted"},"409":{"description":"Update Nothing","schema":{"$ref":"#/definitions/Error"}},"default":{"description":"Unexpected Error","schema":{"$ref":"#/definitions/Error"}}}}},"/version":{"parameters":[],"get":{"tags":["version"],"operationId":"checkVersion","responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/Version"}},"default":{"description":"Unexpected Error","schema":{"$ref":"#/definitions/Error"}}}}},"/tuners":{"parameters":[],"get":{"tags":["tuners"],"operationId":"getTuners","responses":{"200":{"description":"OK","schema":{"type":"array","items":{"$ref":"#/definitions/TunerDevice"}}},"default":{"description":"Unexpected Error","schema":{"$ref":"#/definitions/Error"}}}}},"/status":{"parameters":[],"get":{"tags":["status"],"operationId":"getStatus","responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/Status"}},"default":{"description":"Unexpected Error","schema":{"$ref":"#/definitions/Error"}}}}},"/services":{"parameters":[],"get":{"tags":["services"],"operationId":"getServices","parameters":[{"in":"query","name":"serviceId","type":"integer","required":false},{"in":"query","name":"networkId","type":"integer","required":false},{"in":"query","name":"name","type":"string","required":false},{"in":"query","name":"type","type":"integer","required":false},{"in":"query","name":"channel.type","type":"string","enum":["GR","BS","CS","SKY"],"required":false},{"in":"query","name":"channel.channel","type":"string","required":false}],"responses":{"200":{"description":"OK","schema":{"type":"array","items":{"$ref":"#/definitions/Service"}}},"default":{"description":"Unexpected Error","schema":{"$ref":"#/definitions/Error"}}}}},"/restart":{"parameters":[],"put":{"tags":["misc"],"operationId":"restart","produces":["application/json"],"responses":{"202":{"description":"Accepted"},"default":{"description":"Unexpected Error","schema":{"$ref":"#/definitions/Error"}}}}},"/programs":{"parameters":[],"get":{"tags":["programs"],"operationId":"getPrograms","parameters":[{"in":"query","name":"networkId","type":"integer","required":false},{"in":"query","name":"serviceId","type":"integer","required":false},{"in":"query","name":"eventId","type":"integer","required":false}],"responses":{"200":{"description":"OK","schema":{"type":"array","items":{"$ref":"#/definitions/Program"}}},"default":{"description":"Unexpected Error","schema":{"$ref":"#/definitions/Error"}}}}},"/log/stream":{"parameters":[],"get":{"tags":["log","stream"],"operationId":"getLogStream","responses":{"200":{"description":"OK"},"default":{"description":"Unexpected Error"}}}},"/log":{"parameters":[],"get":{"tags":["log"],"operationId":"getLog","produces":["text/plain"],"responses":{"200":{"description":"OK"},"default":{"description":"Unexpected Error"}}}},"/events/stream":{"parameters":[],"get":{"tags":["events","stream"],"operationId":"getEventsStream","parameters":[{"in":"query","name":"resource","type":"string","enum":["program","service","tuner"],"required":false},{"in":"query","name":"type","type":"string","enum":["create","update","redefine"],"required":false}],"responses":{"200":{"description":"OK","schema":{"type":"array","items":{"$ref":"#/definitions/Event"}}},"default":{"description":"Unexpected Error","schema":{"$ref":"#/definitions/Error"}}}}},"/events":{"parameters":[],"get":{"tags":["events"],"operationId":"getEvents","responses":{"200":{"description":"OK","schema":{"type":"array","items":{"$ref":"#/definitions/Event"}}},"default":{"description":"Unexpected Error","schema":{"$ref":"#/definitions/Error"}}}}},"/config/tuners":{"parameters":[],"get":{"tags":["config"],"operationId":"getTunersConfig","responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/ConfigTuners"}},"default":{"description":"Unexpected Error","schema":{"$ref":"#/definitions/Error"}}}},"put":{"tags":["config"],"operationId":"updateTunersConfig","parameters":[{"in":"body","name":"body","schema":{"$ref":"#/definitions/ConfigTuners"}}],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/ConfigTuners"}},"default":{"description":"Unexpected Error","schema":{"$ref":"#/definitions/Error"}}}}},"/config/server":{"parameters":[],"get":{"tags":["config"],"operationId":"getServerConfig","responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/ConfigServer"}},"default":{"description":"Unexpected Error","schema":{"$ref":"#/definitions/Error"}}}},"put":{"tags":["config"],"operationId":"updateServerConfig","parameters":[{"in":"body","name":"body","schema":{"$ref":"#/definitions/ConfigServer"}}],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/ConfigServer"}},"default":{"description":"Unexpected Error","schema":{"$ref":"#/definitions/Error"}}}}},"/config/channels/scan":{"parameters":[],"put":{"tags":["config"],"operationId":"channelScan","produces":["text/plain","application/json"],"parameters":[{"in":"query","name":"type","type":"string","enum":["GR"],"default":"GR"},{"in":"query","name":"min","type":"integer","default":13},{"in":"query","name":"max","type":"integer","default":52}],"responses":{"200":{"description":"OK"},"409":{"description":"Already Scanning","schema":{"$ref":"#/definitions/Error"}},"default":{"description":"Unexpected Error","schema":{"$ref":"#/definitions/Error"}}}}},"/config/channels":{"parameters":[],"get":{"tags":["config"],"operationId":"getChannelsConfig","responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/ConfigChannels"}},"default":{"description":"Unexpected Error","schema":{"$ref":"#/definitions/Error"}}}},"put":{"tags":["config"],"operationId":"updateChannelsConfig","parameters":[{"in":"body","name":"body","schema":{"$ref":"#/definitions/ConfigChannels"}}],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/ConfigChannels"}},"default":{"description":"Unexpected Error","schema":{"$ref":"#/definitions/Error"}}}}},"/channels":{"parameters":[],"get":{"tags":["channels"],"operationId":"getChannels","parameters":[{"in":"query","name":"type","type":"string","enum":["GR","BS","CS","SKY"],"required":false},{"in":"query","name":"channel","type":"string","required":false},{"in":"query","name":"name","type":"string","required":false}],"responses":{"200":{"description":"OK","schema":{"type":"array","items":{"$ref":"#/definitions/Channel"}}},"default":{"description":"Unexpected Error","schema":{"$ref":"#/definitions/Error"}}}}},"/tuners/{index}/process":{"parameters":[{"in":"path","name":"index","type":"integer","minimum":0,"required":true}],"get":{"tags":["tuners"],"operationId":"getTunerProcess","responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/TunerProcess"}},"404":{"description":"Not Found","schema":{"$ref":"#/definitions/Error"}},"default":{"description":"Unexpected Error","schema":{"$ref":"#/definitions/Error"}}}},"delete":{"tags":["tuners"],"operationId":"killTunerProcess","responses":{"200":{"description":"OK","schema":{"type":"object","properties":{"pid":{"type":"null"}}}},"404":{"description":"Not Found","schema":{"$ref":"#/definitions/Error"}},"default":{"description":"Unexpected Error","schema":{"$ref":"#/definitions/Error"}}}}},"/tuners/{index}":{"parameters":[{"in":"path","name":"index","type":"integer","minimum":0,"required":true}],"get":{"tags":["tuners"],"operationId":"getTuner","responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/TunerDevice"}},"404":{"description":"Not Found","schema":{"$ref":"#/definitions/Error"}},"default":{"description":"Unexpected Error","schema":{"$ref":"#/definitions/Error"}}}}},"/services/{id}/stream":{"parameters":[{"in":"path","name":"id","type":"integer","maximum":6553565535,"required":true},{"in":"header","name":"X-Mirakurun-Priority","type":"integer","minimum":0},{"in":"query","name":"decode","type":"integer","minimum":0,"maximum":1}],"get":{"tags":["services","stream"],"operationId":"getServiceStream","produces":["video/MP2T"],"responses":{"200":{"description":"OK"},"404":{"description":"Not Found"},"503":{"description":"Tuner Resource Unavailable"},"default":{"description":"Unexpected Error"}}}},"/services/{id}/logo":{"parameters":[{"in":"path","name":"id","type":"integer","maximum":6553565535,"required":true}],"get":{"tags":["services"],"operationId":"getLogoImage","produces":["image/png"],"responses":{"200":{"description":"OK"},"404":{"description":"Not Found"},"503":{"description":"Logo Data Unavailable"},"default":{"description":"Unexpected Error"}}}},"/services/{id}":{"parameters":[{"in":"path","name":"id","type":"integer","maximum":6553565535,"required":true}],"get":{"tags":["services"],"operationId":"getService","responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/Service"}},"404":{"description":"Not Found","schema":{"$ref":"#/definitions/Error"}},"default":{"description":"Unexpected Error","schema":{"$ref":"#/definitions/Error"}}}}},"/programs/{id}/stream":{"parameters":[{"in":"path","name":"id","type":"integer","minimum":10000000000,"maximum":655356553565535,"required":true},{"in":"header","name":"X-Mirakurun-Priority","type":"integer","minimum":0},{"in":"query","name":"decode","type":"integer","minimum":0,"maximum":1}],"get":{"tags":["programs","stream"],"operationId":"getProgramStream","produces":["video/MP2T"],"responses":{"200":{"description":"OK"},"404":{"description":"Not Found"},"503":{"description":"Tuner Resource Unavailable"},"default":{"description":"Unexpected Error"}}}},"/programs/{id}":{"parameters":[{"in":"path","name":"id","type":"integer","minimum":10000000000,"maximum":655356553565535,"required":true}],"get":{"tags":["programs"],"operationId":"getProgram","responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/Program"}},"404":{"description":"Not Found","schema":{"$ref":"#/definitions/Error"}},"default":{"description":"Unexpected Error","schema":{"$ref":"#/definitions/Error"}}}}},"/channels/{type}/{channel}/stream":{"parameters":[{"in":"path","name":"type","type":"string","enum":["GR","BS","CS","SKY"],"required":true},{"in":"path","name":"channel","type":"string","required":true},{"in":"header","name":"X-Mirakurun-Priority","type":"integer","minimum":0},{"in":"query","name":"decode","type":"integer","minimum":0,"maximum":1}],"get":{"tags":["channels","stream"],"operationId":"getChannelStream","produces":["video/MP2T"],"responses":{"200":{"description":"OK"},"404":{"description":"Not Found"},"503":{"description":"Tuner Resource Unavailable"},"default":{"description":"Unexpected Error"}}}},"/channels/{type}/{channel}/services/{id}/stream":{"parameters":[{"in":"path","name":"type","type":"string","enum":["GR","BS","CS","SKY"],"required":true},{"in":"path","name":"channel","type":"string","required":true},{"in":"path","name":"id","type":"integer","maximum":6553565535,"required":true},{"in":"header","name":"X-Mirakurun-Priority","type":"integer","minimum":0},{"in":"query","name":"decode","type":"integer","minimum":0,"maximum":1}],"get":{"tags":["channels","services","stream"],"operationId":"getServiceStreamByChannel","produces":["video/MP2T"],"responses":{"200":{"description":"OK"},"404":{"description":"Not Found"},"503":{"description":"Tuner Resource Unavailable"},"default":{"description":"Unexpected Error"}}}},"/channels/{type}/{channel}/services/{id}":{"parameters":[{"in":"path","name":"type","type":"string","enum":["GR","BS","CS","SKY"],"required":true},{"in":"path","name":"channel","type":"string","required":true},{"in":"path","name":"id","type":"integer","maximum":6553565535,"required":true}],"get":{"tags":["channels","services"],"operationId":"getServiceByChannel","responses":{"200":{"description":"OK","schema":{"type":"array","items":{"$ref":"#/definitions/Service"}}},"default":{"description":"Unexpected Error","schema":{"$ref":"#/definitions/Error"}}}}},"/channels/{type}/{channel}/services":{"parameters":[{"in":"path","name":"type","type":"string","enum":["GR","BS","CS","SKY"],"required":true},{"in":"path","name":"channel","type":"string","required":true}],"get":{"tags":["channels","services"],"operationId":"getServicesByChannel","responses":{"200":{"description":"OK","schema":{"type":"array","items":{"$ref":"#/definitions/Service"}}},"default":{"description":"Unexpected Error","schema":{"$ref":"#/definitions/Error"}}}}},"/channels/{type}/{channel}":{"parameters":[{"in":"path","name":"type","type":"string","enum":["GR","BS","CS","SKY"],"required":true},{"in":"path","name":"channel","type":"string","required":true}],"get":{"tags":["channels"],"operationId":"getChannel","responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/Channel"}},"404":{"description":"Not Found","schema":{"$ref":"#/definitions/Error"}},"default":{"description":"Unexpected Error","schema":{"$ref":"#/definitions/Error"}}}}},"/channels/{type}":{"parameters":[{"in":"path","name":"type","type":"string","enum":["GR","BS","CS","SKY"],"required":true}],"get":{"tags":["channels"],"operationId":"getChannelsByType","parameters":[{"in":"query","name":"channel","type":"string","required":false},{"in":"query","name":"name","type":"string","required":false}],"responses":{"200":{"description":"OK","schema":{"type":"array","items":{"$ref":"#/definitions/Channel"}}},"default":{"description":"Unexpected Error","schema":{"$ref":"#/definitions/Error"}}}}}},"definitions":{"Error":{"type":"object","properties":{"code":{"type":"integer"},"reason":{"type":"string"},"errors":{"type":"array","items":{"$ref":"#/definitions/ErrorOfOpenAPI"}}}},"ErrorOfOpenAPI":{"type":"object","properties":{"errorCode":{"type":"string"},"message":{"type":"string"},"location":{"type":"string"}}},"ProgramId":{"type":"integer","maximum":655356553565535},"EventId":{"type":"integer","maximum":65535},"ServiceId":{"type":"integer","maximum":65535},"NetworkId":{"type":"integer","maximum":65535},"ServiceItemId":{"type":"integer","maximum":6553565535},"UnixtimeMS":{"type":"integer"},"Channel":{"type":"object","required":["type","channel"],"properties":{"type":{"$ref":"#/definitions/ChannelType"},"channel":{"type":"string"},"name":{"type":"string"},"satelite":{"type":"string"},"space":{"type":"number"},"services":{"type":"array","items":{"$ref":"#/definitions/Service"}}}},"ChannelType":{"type":"string","enum":["GR","BS","CS","SKY"]},"Service":{"type":"object","required":["id","serviceId","networkId","name"],"properties":{"id":{"$ref":"#/definitions/ServiceItemId"},"serviceId":{"$ref":"#/definitions/ServiceId"},"networkId":{"$ref":"#/definitions/NetworkId"},"name":{"type":"string"},"logoId":{"type":"integer"},"hasLogoData":{"type":"boolean"},"remoteControlKeyId":{"type":"integer"},"channel":{"$ref":"#/definitions/Channel"}}},"Program":{"type":"object","required":["id","eventId","serviceId","networkId","startAt","duration","isFree"],"properties":{"id":{"$ref":"#/definitions/ProgramId"},"eventId":{"$ref":"#/definitions/EventId"},"serviceId":{"$ref":"#/definitions/ServiceId"},"networkId":{"$ref":"#/definitions/NetworkId"},"startAt":{"$ref":"#/definitions/UnixtimeMS"},"duration":{"type":"integer"},"isFree":{"type":"boolean"},"name":{"type":"string"},"description":{"type":"string"},"genres":{"type":"array","items":{"$ref":"#/definitions/ProgramGenre"}},"video":{"type":"object","properties":{"type":{"$ref":"#/definitions/ProgramVideoType"},"resolution":{"$ref":"#/definitions/ProgramVideoResolution"},"streamContent":{"type":"integer"},"componentType":{"type":"integer"}}},"audio":{"type":"object","properties":{"samplingRate":{"$ref":"#/definitions/ProgramAudioSamplingRate"},"componentType":{"type":"integer"}}},"extended":{"type":"object"},"relatedItems":{"type":"array","items":{"$ref":"#/definitions/RelatedItem"}},"series":{"type":"object","properties":{"id":{"type":"integer"},"repeat":{"type":"integer","minimum":0},"pattern":{"$ref":"#/definitions/ProgramPattern"},"expiresAt":{"$ref":"#/definitions/UnixtimeMS"},"episode":{"$ref":"#/definitions/ProgramEpisodeNumber"},"lastEpisode":{"$ref":"#/definitions/ProgramEpisodeNumber"},"name":{"type":"string"}}}}},"ProgramGenre":{"type":"object","properties":{"lv1":{"type":"integer"},"lv2":{"type":"integer"},"un1":{"type":"integer"},"un2":{"type":"integer"}}},"ProgramVideoType":{"type":"string","enum":["mpeg2","h.264","h.265"]},"ProgramVideoResolution":{"type":"string","enum":["240p","480i","480p","720p","1080i","1080p","2160p","4320p"]},"ProgramAudioSamplingRate":{"type":"integer","enum":[16000,22050,24000,32000,44100,48000]},"ProgramPattern":{"type":"integer","minimum":0,"maximum":7},"ProgramEpisodeNumber":{"type":"integer","minimum":1,"maximum":4095},"RelatedItem":{"type":"object","properties":{"networkId":{"type":"integer"},"serviceId":{"type":"integer"},"eventId":{"type":"integer"}}},"TunerDevice":{"type":"object","required":["index","name","types","command","pid","users","isAvailable","isFree","isUsing","isFault"],"properties":{"index":{"type":"integer"},"name":{"type":"string"},"types":{"type":"array","items":{"$ref":"#/definitions/ChannelType"}},"command":{"type":"string"},"pid":{"type":"integer"},"users":{"type":"array","items":{"$ref":"#/definitions/TunerUser"}},"isAvailable":{"type":"boolean"},"isRemote":{"type":"boolean"},"isFree":{"type":"boolean"},"isUsing":{"type":"boolean"},"isFault":{"type":"boolean"}}},"TunerUser":{"type":"object","required":["id","priority"],"properties":{"id":{"type":"string"},"priority":{"type":"integer","minimum":-1},"agent":{"type":"string"}}},"TunerProcess":{"type":"object","required":["pid"],"properties":{"pid":{"type":"integer"}}},"Event":{"type":"object","required":["resource","type","data","time"],"properties":{"resource":{"$ref":"#/definitions/EventResource"},"type":{"$ref":"#/definitions/EventType"},"data":{"type":"object"},"time":{"$ref":"#/definitions/UnixtimeMS"}}},"EventResource":{"type":"string","enum":["program","service","tuner"]},"EventType":{"type":"string","enum":["create","update","redefine"]},"ConfigServer":{"type":"object","properties":{"path":{"type":"string"},"port":{"type":"integer","minimum":1,"maximum":65535},"disableIPv6":{"type":"boolean"},"logLevel":{"type":"integer","minimum":-1,"maximum":3},"maxLogHistory":{"type":"integer","minimum":0},"highWaterMark":{"type":"integer"},"overflowTimeLimit":{"type":"integer"},"maxBufferBytesBeforeReady":{"type":"integer"},"eventEndTimeout":{"type":"integer","minimum":0},"programGCInterval":{"type":"integer"},"epgGatheringInterval":{"type":"integer"},"epgRetrievalTime":{"type":"integer"}}},"ConfigTuners":{"type":"array","items":{"$ref":"#/definitions/ConfigTunersItem"}},"ConfigTunersItem":{"type":"object","required":["name","types"],"properties":{"name":{"type":"string","maxLength":8},"types":{"type":"array","items":{"$ref":"#/definitions/ChannelType"}},"command":{"type":"string"},"dvbDevicePath":{"type":"string"},"remoteMirakurunHost":{"type":"string"},"remoteMirakurunPort":{"type":"integer"},"remoteMirakurunDecoder":{"type":"boolean"},"decoder":{"type":"string"},"isDisabled":{"type":"boolean"}}},"ConfigChannels":{"type":"array","items":{"$ref":"#/definitions/ConfigChannelsItem"}},"ConfigChannelsItem":{"type":"object","required":["name","type","channel"],"properties":{"name":{"type":"string"},"type":{"$ref":"#/definitions/ChannelType"},"channel":{"type":"string"},"serviceId":{"$ref":"#/definitions/ServiceId"},"satelite":{"type":"string"},"space":{"type":"number"},"isDisabled":{"type":"boolean"}}},"Version":{"type":"object","properties":{"current":{"type":"string"},"latest":{"type":"string"}}},"Status":{"type":"object","properties":{"time":{"type":"integer"},"version":{"type":"string"},"process":{"type":"object","properties":{"arch":{"type":"string"},"platform":{"type":"string"},"versions":{"type":"object"},"env":{"type":"object"},"pid":{"type":"integer"},"memoryUsage":{"type":"object","properties":{"rss":{"type":"integer"},"heapTotal":{"type":"integer"},"heapUsed":{"type":"integer"}}}}},"epg":{"type":"object","properties":{"gatheringNetworks":{"type":"array","items":{"$ref":"#/definitions/NetworkId"}},"storedEvents":{"type":"integer"}}},"streamCount":{"type":"object","properties":{"tunerDevice":{"type":"integer"},"tsFilter":{"type":"integer"},"decoder":{"type":"integer"}}},"errorCount":{"type":"object","properties":{"uncaughtException":{"type":"integer"},"unhandledRejection":{"type":"integer"},"bufferOverflow":{"type":"integer"},"tunerDeviceRespawn":{"type":"integer"}}},"timerAccuracy":{"type":"object","properties":{"last":{"type":"number"},"m1":{"type":"object","properties":{"avg":{"type":"number"},"min":{"type":"number"},"max":{"type":"number"}}},"m5":{"type":"object","properties":{"avg":{"type":"number"},"min":{"type":"number"},"max":{"type":"number"}}},"m15":{"type":"object","properties":{"avg":{"type":"number"},"min":{"type":"number"},"max":{"type":"number"}}}}}}}},"tags":[{"name":"version"},{"name":"tuners"},{"name":"status"},{"name":"services"},{"name":"misc"},{"name":"programs"},{"name":"log"},{"name":"stream"},{"name":"events"},{"name":"config"},{"name":"channels"}],"host":"localhost:40772"}